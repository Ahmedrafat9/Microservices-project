{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_GCP_61", "bc_check_id": "BC_GCP_KUBERNETES_18", "check_name": "Enable VPC Flow Logs and Intranode Visibility", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_intranode_visibility"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnableVPCFlowLogs", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/enable-vpc-flow-logs-and-intranode-visibility", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_69", "bc_check_id": "BC_GCP_KUBERNETES_23", "check_name": "Ensure the GKE Metadata Server is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMetadataServerIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_72", "bc_check_id": "BC_GCP_KUBERNETES_25", "check_name": "Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_integrity_monitoring"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnsureIntegrityMonitoring", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_66", "bc_check_id": "BC_GCP_KUBERNETES_21", "check_name": "Ensure use of Binary Authorization", "check_result": {"result": "PASSED", "evaluated_keys": ["binary_authorization", "enable_binary_authorization"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEBinaryAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-use-of-binary-authorization", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_23", "bc_check_id": "BC_GCP_KUBERNETES_15", "check_name": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ip_allocation_policy"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEAliasIpEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-15", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_12", "bc_check_id": "BC_GCP_KUBERNETES_7", "check_name": "Ensure Network Policy is enabled on Kubernetes Engine Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["network_policy/[0]/enabled"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENetworkPolicyEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-7", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_21", "bc_check_id": "BC_GCP_KUBERNETES_13", "check_name": "Ensure Kubernetes Clusters are configured with Labels", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_labels"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEHasLabels", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-13", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_70", "bc_check_id": "BC_GCP_KUBERNETES_26", "check_name": "Ensure the GKE Release Channel is set", "check_result": {"result": "PASSED", "evaluated_keys": ["release_channel/[0]/channel"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEReleaseChannel", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-release-channel-is-set", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_25", "bc_check_id": "BC_GCP_KUBERNETES_6", "check_name": "Ensure Kubernetes Cluster is created with Private cluster enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["private_cluster_config"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPrivateClusterConfig", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-6", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_20", "bc_check_id": "BC_GCP_KUBERNETES_12", "check_name": "Ensure master authorized networks is set to enabled in GKE clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["master_authorized_networks_config"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMasterAuthorizedNetworksEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-12", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_123", "bc_check_id": "BC_GCP_KUBERNETES_28", "check_name": "GKE Don't Use NodePools in the Cluster configuration", "check_result": {"result": "PASSED", "evaluated_keys": ["node_pool"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEDontUseNodePools", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-google-cloud-123", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_8", "bc_check_id": "BC_GCP_KUBERNETES_3", "check_name": "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["monitoring_service/0"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMonitoringEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-3", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_1", "bc_check_id": "BC_GCP_KUBERNETES_1", "check_name": "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["logging_service"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEClusterLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_68", "bc_check_id": "BC_GCP_KUBERNETES_17", "check_name": "Ensure Secure Boot for Shielded GKE Nodes is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_secure_boot"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKESecureBootforShieldedNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-secure-boot-for-shielded-gke-nodes-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_13", "bc_check_id": "BC_GCP_KUBERNETES_8", "check_name": "Ensure client certificate authentication to Kubernetes Engine Clusters is disabled", "check_result": {"result": "PASSED", "evaluated_keys": ["master_auth/[0]/client_certificate_config/[0]/issue_client_certificate/[0]"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEClientCertificateDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-8", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_18", "bc_check_id": "BC_GCP_KUBERNETES_10", "check_name": "Ensure GKE Control Plane is not public", "check_result": {"result": "PASSED", "evaluated_keys": ["master_authorized_networks_config/[0]/cidr_blocks"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPublicControlPlane", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-10", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_64", "bc_check_id": "BC_GCP_KUBERNETES_19", "check_name": "Ensure clusters are created with Private Nodes", "check_result": {"result": "PASSED", "evaluated_keys": ["private_cluster_config"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPrivateNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-clusters-are-created-with-private-nodes", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_7", "bc_check_id": "BC_GCP_KUBERNETES_2", "check_name": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_legacy_abac"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEDisableLegacyAuth", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_71", "bc_check_id": "BC_GCP_KUBERNETES_24", "check_name": "Ensure Shielded GKE Nodes are Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_shielded_nodes"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnableShieldedNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-shielded-gke-nodes-are-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_69", "bc_check_id": "BC_GCP_KUBERNETES_23", "check_name": "Ensure the GKE Metadata Server is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config"]}, "code_block": [[83, "resource \"google_container_node_pool\" \"primary_nodes\" {\n"], [84, "  provider   = google-beta\n"], [85, "  name       = \"primary-node-pool\"\n"], [86, "  cluster    = google_container_cluster.gke.name\n"], [87, "  location   = var.region\n"], [88, "  initial_node_count = 1\n"], [89, "  project    = var.project_id\n"], [90, "\n"], [91, "  management {\n"], [92, "    auto_upgrade = true\n"], [93, "    auto_repair  = true\n"], [94, "  }\n"], [95, "  autoscaling {\n"], [96, "    min_node_count = 1\n"], [97, "    max_node_count = var.node_count\n"], [98, "  }\n"], [99, "\n"], [100, "  node_config {\n"], [101, "    machine_type    = var.machine_type\n"], [102, "    disk_size_gb    = 40\n"], [103, "    disk_type       = \"pd-ssd\"\n"], [104, "\n"], [105, "    workload_metadata_config {\n"], [106, "      mode = \"GKE_METADATA\"\n"], [107, "    }\n"], [108, "\n"], [109, "    shielded_instance_config {\n"], [110, "      enable_secure_boot          = true\n"], [111, "      enable_integrity_monitoring = true\n"], [112, "    }\n"], [113, "\n"], [114, "    sandbox_config {\n"], [115, "      sandbox_type = \"gvisor\"\n"], [116, "    }\n"], [117, "\n"], [118, "\n"], [119, "    oauth_scopes = [\n"], [120, "      \"https://www.googleapis.com/auth/cloud-platform\"\n"], [121, "    ]\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [83, 123], "resource": "module.gke.google_container_node_pool.primary_nodes", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMetadataServerIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "autoscaling.max_node_count": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_count", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "node_config.machine_type": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_72", "bc_check_id": "BC_GCP_KUBERNETES_25", "check_name": "Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_integrity_monitoring"]}, "code_block": [[83, "resource \"google_container_node_pool\" \"primary_nodes\" {\n"], [84, "  provider   = google-beta\n"], [85, "  name       = \"primary-node-pool\"\n"], [86, "  cluster    = google_container_cluster.gke.name\n"], [87, "  location   = var.region\n"], [88, "  initial_node_count = 1\n"], [89, "  project    = var.project_id\n"], [90, "\n"], [91, "  management {\n"], [92, "    auto_upgrade = true\n"], [93, "    auto_repair  = true\n"], [94, "  }\n"], [95, "  autoscaling {\n"], [96, "    min_node_count = 1\n"], [97, "    max_node_count = var.node_count\n"], [98, "  }\n"], [99, "\n"], [100, "  node_config {\n"], [101, "    machine_type    = var.machine_type\n"], [102, "    disk_size_gb    = 40\n"], [103, "    disk_type       = \"pd-ssd\"\n"], [104, "\n"], [105, "    workload_metadata_config {\n"], [106, "      mode = \"GKE_METADATA\"\n"], [107, "    }\n"], [108, "\n"], [109, "    shielded_instance_config {\n"], [110, "      enable_secure_boot          = true\n"], [111, "      enable_integrity_monitoring = true\n"], [112, "    }\n"], [113, "\n"], [114, "    sandbox_config {\n"], [115, "      sandbox_type = \"gvisor\"\n"], [116, "    }\n"], [117, "\n"], [118, "\n"], [119, "    oauth_scopes = [\n"], [120, "      \"https://www.googleapis.com/auth/cloud-platform\"\n"], [121, "    ]\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [83, 123], "resource": "module.gke.google_container_node_pool.primary_nodes", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnsureIntegrityMonitoring", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "autoscaling.max_node_count": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_count", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "node_config.machine_type": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_10", "bc_check_id": "BC_GCP_KUBERNETES_5", "check_name": "Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["management/[0]/auto_upgrade/[0]"]}, "code_block": [[83, "resource \"google_container_node_pool\" \"primary_nodes\" {\n"], [84, "  provider   = google-beta\n"], [85, "  name       = \"primary-node-pool\"\n"], [86, "  cluster    = google_container_cluster.gke.name\n"], [87, "  location   = var.region\n"], [88, "  initial_node_count = 1\n"], [89, "  project    = var.project_id\n"], [90, "\n"], [91, "  management {\n"], [92, "    auto_upgrade = true\n"], [93, "    auto_repair  = true\n"], [94, "  }\n"], [95, "  autoscaling {\n"], [96, "    min_node_count = 1\n"], [97, "    max_node_count = var.node_count\n"], [98, "  }\n"], [99, "\n"], [100, "  node_config {\n"], [101, "    machine_type    = var.machine_type\n"], [102, "    disk_size_gb    = 40\n"], [103, "    disk_type       = \"pd-ssd\"\n"], [104, "\n"], [105, "    workload_metadata_config {\n"], [106, "      mode = \"GKE_METADATA\"\n"], [107, "    }\n"], [108, "\n"], [109, "    shielded_instance_config {\n"], [110, "      enable_secure_boot          = true\n"], [111, "      enable_integrity_monitoring = true\n"], [112, "    }\n"], [113, "\n"], [114, "    sandbox_config {\n"], [115, "      sandbox_type = \"gvisor\"\n"], [116, "    }\n"], [117, "\n"], [118, "\n"], [119, "    oauth_scopes = [\n"], [120, "      \"https://www.googleapis.com/auth/cloud-platform\"\n"], [121, "    ]\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [83, 123], "resource": "module.gke.google_container_node_pool.primary_nodes", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENodePoolAutoUpgradeEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-5", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "autoscaling.max_node_count": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_count", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "node_config.machine_type": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_9", "bc_check_id": "BC_GCP_KUBERNETES_4", "check_name": "Ensure 'Automatic node repair' is enabled for Kubernetes Clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["management/[0]/auto_repair/[0]"]}, "code_block": [[83, "resource \"google_container_node_pool\" \"primary_nodes\" {\n"], [84, "  provider   = google-beta\n"], [85, "  name       = \"primary-node-pool\"\n"], [86, "  cluster    = google_container_cluster.gke.name\n"], [87, "  location   = var.region\n"], [88, "  initial_node_count = 1\n"], [89, "  project    = var.project_id\n"], [90, "\n"], [91, "  management {\n"], [92, "    auto_upgrade = true\n"], [93, "    auto_repair  = true\n"], [94, "  }\n"], [95, "  autoscaling {\n"], [96, "    min_node_count = 1\n"], [97, "    max_node_count = var.node_count\n"], [98, "  }\n"], [99, "\n"], [100, "  node_config {\n"], [101, "    machine_type    = var.machine_type\n"], [102, "    disk_size_gb    = 40\n"], [103, "    disk_type       = \"pd-ssd\"\n"], [104, "\n"], [105, "    workload_metadata_config {\n"], [106, "      mode = \"GKE_METADATA\"\n"], [107, "    }\n"], [108, "\n"], [109, "    shielded_instance_config {\n"], [110, "      enable_secure_boot          = true\n"], [111, "      enable_integrity_monitoring = true\n"], [112, "    }\n"], [113, "\n"], [114, "    sandbox_config {\n"], [115, "      sandbox_type = \"gvisor\"\n"], [116, "    }\n"], [117, "\n"], [118, "\n"], [119, "    oauth_scopes = [\n"], [120, "      \"https://www.googleapis.com/auth/cloud-platform\"\n"], [121, "    ]\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [83, 123], "resource": "module.gke.google_container_node_pool.primary_nodes", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENodePoolAutoRepairEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-4", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "autoscaling.max_node_count": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_count", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "node_config.machine_type": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_68", "bc_check_id": "BC_GCP_KUBERNETES_17", "check_name": "Ensure Secure Boot for Shielded GKE Nodes is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_secure_boot"]}, "code_block": [[83, "resource \"google_container_node_pool\" \"primary_nodes\" {\n"], [84, "  provider   = google-beta\n"], [85, "  name       = \"primary-node-pool\"\n"], [86, "  cluster    = google_container_cluster.gke.name\n"], [87, "  location   = var.region\n"], [88, "  initial_node_count = 1\n"], [89, "  project    = var.project_id\n"], [90, "\n"], [91, "  management {\n"], [92, "    auto_upgrade = true\n"], [93, "    auto_repair  = true\n"], [94, "  }\n"], [95, "  autoscaling {\n"], [96, "    min_node_count = 1\n"], [97, "    max_node_count = var.node_count\n"], [98, "  }\n"], [99, "\n"], [100, "  node_config {\n"], [101, "    machine_type    = var.machine_type\n"], [102, "    disk_size_gb    = 40\n"], [103, "    disk_type       = \"pd-ssd\"\n"], [104, "\n"], [105, "    workload_metadata_config {\n"], [106, "      mode = \"GKE_METADATA\"\n"], [107, "    }\n"], [108, "\n"], [109, "    shielded_instance_config {\n"], [110, "      enable_secure_boot          = true\n"], [111, "      enable_integrity_monitoring = true\n"], [112, "    }\n"], [113, "\n"], [114, "    sandbox_config {\n"], [115, "      sandbox_type = \"gvisor\"\n"], [116, "    }\n"], [117, "\n"], [118, "\n"], [119, "    oauth_scopes = [\n"], [120, "      \"https://www.googleapis.com/auth/cloud-platform\"\n"], [121, "    ]\n"], [122, "  }\n"], [123, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [83, 123], "resource": "module.gke.google_container_node_pool.primary_nodes", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKESecureBootforShieldedNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-secure-boot-for-shielded-gke-nodes-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "autoscaling.max_node_count": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "node_count", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "node_config.machine_type": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV_GCP_37", "bc_check_id": "BC_GCP_GENERAL_1", "check_name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "check_result": {"result": "PASSED", "evaluated_keys": ["disk_encryption_key"]}, "code_block": [[12, "resource \"google_compute_disk\" \"jenkins_disk\" {\n"], [13, "  name    = \"jenkins-disk\"\n"], [14, "  type    = \"pd-ssd\"\n"], [15, "  zone    = var.zone\n"], [16, "  size    = var.disk_size\n"], [17, "  project = var.project_id\n"], [18, "\n"], [19, "  image = var.jenkins_instance_image\n"], [20, "\n"], [21, "  disk_encryption_key {\n"], [22, "    raw_key = random_id.disk_encryption_key.b64_std\n"], [23, "  }\n"], [24, "\n"], [25, "  labels = {\n"], [26, "    environment = var.environment\n"], [27, "    purpose     = \"jenkins\"\n"], [28, "  }\n"], [29, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [12, 29], "resource": "module.jenkins.google_compute_disk.jenkins_disk", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDiskEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-x", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"image": [{"type": "variable", "name": "jenkins_instance_image", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "size": [{"type": "variable", "name": "disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_117", "bc_check_id": "BC_GCP_IAM_16", "check_name": "Ensure basic roles are not used at project level.", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[39, "resource \"google_project_iam_member\" \"jenkins_compute_admin\" {\n"], [40, "  project = var.project_id\n"], [41, "  role    = \"roles/compute.admin\"\n"], [42, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [43, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [39, 43], "resource": "module.jenkins.google_project_iam_member.jenkins_compute_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectBasicRole", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-google-cloud-117", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_42", "bc_check_id": "BC_GCP_IAM_4", "check_name": "Ensure that Service Account has no Admin privileges", "check_result": {"result": "PASSED", "evaluated_keys": ["member", "role"]}, "code_block": [[39, "resource \"google_project_iam_member\" \"jenkins_compute_admin\" {\n"], [40, "  project = var.project_id\n"], [41, "  role    = \"roles/compute.admin\"\n"], [42, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [43, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [39, 43], "resource": "module.jenkins.google_project_iam_member.jenkins_compute_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectAdminServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-4", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_41", "bc_check_id": "BC_GCP_IAM_3", "check_name": "Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[39, "resource \"google_project_iam_member\" \"jenkins_compute_admin\" {\n"], [40, "  project = var.project_id\n"], [41, "  role    = \"roles/compute.admin\"\n"], [42, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [43, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [39, 43], "resource": "module.jenkins.google_project_iam_member.jenkins_compute_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleRoleServiceAccountUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-3", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_46", "bc_check_id": "BC_GCP_IAM_7", "check_name": "Ensure Default Service account is not used at a project level", "check_result": {"result": "PASSED", "evaluated_keys": ["member"]}, "code_block": [[39, "resource \"google_project_iam_member\" \"jenkins_compute_admin\" {\n"], [40, "  project = var.project_id\n"], [41, "  role    = \"roles/compute.admin\"\n"], [42, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [43, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [39, 43], "resource": "module.jenkins.google_project_iam_member.jenkins_compute_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectMemberDefaultServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-7", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_49", "bc_check_id": "BC_GCP_IAM_10", "check_name": "Ensure roles do not impersonate or manage Service Accounts used at project level", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[39, "resource \"google_project_iam_member\" \"jenkins_compute_admin\" {\n"], [40, "  project = var.project_id\n"], [41, "  role    = \"roles/compute.admin\"\n"], [42, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [43, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [39, 43], "resource": "module.jenkins.google_project_iam_member.jenkins_compute_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectImpersonationRole", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-10", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_117", "bc_check_id": "BC_GCP_IAM_16", "check_name": "Ensure basic roles are not used at project level.", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[45, "resource \"google_project_iam_member\" \"jenkins_storage_admin\" {\n"], [46, "  project = var.project_id\n"], [47, "  role    = \"roles/storage.admin\"\n"], [48, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [49, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [45, 49], "resource": "module.jenkins.google_project_iam_member.jenkins_storage_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectBasicRole", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-google-cloud-117", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_42", "bc_check_id": "BC_GCP_IAM_4", "check_name": "Ensure that Service Account has no Admin privileges", "check_result": {"result": "PASSED", "evaluated_keys": ["member", "role"]}, "code_block": [[45, "resource \"google_project_iam_member\" \"jenkins_storage_admin\" {\n"], [46, "  project = var.project_id\n"], [47, "  role    = \"roles/storage.admin\"\n"], [48, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [49, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [45, 49], "resource": "module.jenkins.google_project_iam_member.jenkins_storage_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectAdminServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-4", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_41", "bc_check_id": "BC_GCP_IAM_3", "check_name": "Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[45, "resource \"google_project_iam_member\" \"jenkins_storage_admin\" {\n"], [46, "  project = var.project_id\n"], [47, "  role    = \"roles/storage.admin\"\n"], [48, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [49, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [45, 49], "resource": "module.jenkins.google_project_iam_member.jenkins_storage_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleRoleServiceAccountUser", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-3", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_46", "bc_check_id": "BC_GCP_IAM_7", "check_name": "Ensure Default Service account is not used at a project level", "check_result": {"result": "PASSED", "evaluated_keys": ["member"]}, "code_block": [[45, "resource \"google_project_iam_member\" \"jenkins_storage_admin\" {\n"], [46, "  project = var.project_id\n"], [47, "  role    = \"roles/storage.admin\"\n"], [48, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [49, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [45, 49], "resource": "module.jenkins.google_project_iam_member.jenkins_storage_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectMemberDefaultServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-7", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_49", "bc_check_id": "BC_GCP_IAM_10", "check_name": "Ensure roles do not impersonate or manage Service Accounts used at project level", "check_result": {"result": "PASSED", "evaluated_keys": ["role"]}, "code_block": [[45, "resource \"google_project_iam_member\" \"jenkins_storage_admin\" {\n"], [46, "  project = var.project_id\n"], [47, "  role    = \"roles/storage.admin\"\n"], [48, "  member  = \"serviceAccount:${google_service_account.jenkins_sa.email}\"\n"], [49, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [45, 49], "resource": "module.jenkins.google_project_iam_member.jenkins_storage_admin", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleProjectImpersonationRole", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-10", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_40", "bc_check_id": "BC_GCP_PUBLIC_2", "check_name": "Ensure that Compute instances do not have public IP addresses", "check_result": {"result": "PASSED", "evaluated_keys": ["network_interface/[0]/access_config"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeExternalIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-public-policies/bc-gcp-public-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_32", "bc_check_id": "BC_GCP_NETWORKING_8", "check_name": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata/block-project-ssh-keys"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeBlockProjectSSH", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-8", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_34", "bc_check_id": "BC_GCP_NETWORKING_10", "check_name": "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in project metadata for all instances)", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata/[0]/enable-oslogin"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeInstanceOSLogin", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-10", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_39", "bc_check_id": "BC_GCP_GENERAL_3", "check_name": "Ensure Compute instances are launched with Shielded VM enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["shielded_instance_config", "shielded_instance_config/[0]/enable_vtpm", "shielded_instance_config/[0]/enable_integrity_monitoring"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeShieldedVM", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-y", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_31", "bc_check_id": "BC_GCP_IAM_2", "check_name": "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs", "check_result": {"result": "PASSED", "evaluated_keys": ["service_account/[0]/scopes", "service_account/[0]/email"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDefaultServiceAccountFullAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_36", "bc_check_id": "BC_GCP_NETWORKING_12", "check_name": "Ensure that IP forwarding is not enabled on Instances", "check_result": {"result": "PASSED", "evaluated_keys": ["can_ip_forward"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeIPForward", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-12", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_35", "bc_check_id": "BC_GCP_NETWORKING_11", "check_name": "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata/[0]/serial-port-enable"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeSerialPorts", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-11", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_30", "bc_check_id": "BC_GCP_IAM_1", "check_name": "Ensure that instances are not configured to use the default service account", "check_result": {"result": "PASSED", "evaluated_keys": ["service_account/[0]/email"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDefaultServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_38", "bc_check_id": "BC_GCP_GENERAL_2", "check_name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "check_result": {"result": "PASSED", "evaluated_keys": ["boot_disk", "boot_disk/[0]/disk_encryption_key_raw", "boot_disk/[0]/kms_key_self_link"]}, "code_block": [[52, "resource \"google_compute_instance\" \"jenkins\" {\n"], [53, "  name         = \"jenkins-vm\"\n"], [54, "  machine_type = var.machine_type\n"], [55, "  zone         = var.zone\n"], [56, "  project      = var.project_id\n"], [57, "\n"], [58, "  boot_disk {\n"], [59, "    source                    = google_compute_disk.jenkins_disk.id\n"], [60, "    auto_delete               = true\n"], [61, "    disk_encryption_key_raw   = random_id.disk_encryption_key.b64_std\n"], [62, "  }\n"], [63, "\n"], [64, "  network_interface {\n"], [65, "    subnetwork         = var.subnet\n"], [66, "    subnetwork_project = var.project_id\n"], [67, "\n"], [68, "    #access_config {} # Add public IP\n"], [69, "  }\n"], [70, "\n"], [71, "  metadata = {\n"], [72, "    \"ssh-keys\"               = local.jenkins_ssh_key\n"], [73, "    \"block-project-ssh-keys\" = \"true\"\n"], [74, "  }\n"], [75, "\n"], [76, "  metadata_startup_script = <<-EOT\n"], [77, "    #!/bin/bash\n"], [78, "    apt-get update && apt-get install -y openjdk-17-jdk git curl gnupg2\n"], [79, "    curl -fsSL https://pkg.jenkins.io/debian-stable/jenkins.io.key | tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null\n"], [80, "    echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian-stable binary/ | tee /etc/apt/sources.list.d/jenkins.list > /dev/null\n"], [81, "    apt-get update && apt-get install -y jenkins\n"], [82, "    systemctl enable jenkins && systemctl start jenkins\n"], [83, "  EOT\n"], [84, "\n"], [85, "  tags = [\"jenkins\"]\n"], [86, "\n"], [87, "  service_account {\n"], [88, "    email  = google_service_account.jenkins_sa.email\n"], [89, "    scopes = [\"https://www.googleapis.com/auth/cloud-platform\"]\n"], [90, "  }\n"], [91, "\n"], [92, "  shielded_instance_config {\n"], [93, "    enable_secure_boot          = true\n"], [94, "    enable_vtpm                 = true\n"], [95, "    enable_integrity_monitoring = true\n"], [96, "  }\n"], [97, "\n"], [98, "  labels = {\n"], [99, "    environment = var.environment\n"], [100, "    purpose     = \"jenkins\"\n"], [101, "  }\n"], [102, "}\n"]], "file_path": "/modules/jenkins/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "repo_file_path": "/modules/jenkins/main.tf", "file_line_range": [52, 102], "resource": "module.jenkins.google_compute_instance.jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeBootDiskEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [140, 154], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/encrypt-boot-disks-for-instances-with-cseks", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "breadcrumbs": {"metadata.ssh-keys": [{"type": "locals", "name": "jenkins_ssh_key", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "machine_type": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "machine_type", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork_project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnet", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}], "zone": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "zone", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_instance.jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/jenkins/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "jenkins", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 26, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "PASSED", "evaluated_keys": ["allow"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_26", "bc_check_id": "BC_GCP_LOGGING_1", "check_name": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "check_result": {"result": "PASSED", "evaluated_keys": ["log_config"]}, "code_block": [[7, "resource \"google_compute_subnetwork\" \"subnet\" {\n"], [8, "  project       = var.project_id\n"], [9, "  name          = \"secure-subnet\"\n"], [10, "  ip_cidr_range = \"10.10.0.0/16\"\n"], [11, "  region        = var.region\n"], [12, "  network       = google_compute_network.vpc.id\n"], [13, "  private_ip_google_access = true\n"], [14, "\n"], [15, "  # \u0636\u0631\u0648\u0631\u064a \u0644\u0625\u0636\u0627\u0641\u0629 secondary IP ranges \u0644\u0640 GKE pods \u0648 services\n"], [16, "  secondary_ip_range {\n"], [17, "    range_name    = \"pods-range\"\n"], [18, "    ip_cidr_range = \"10.21.0.0/16\"\n"], [19, "  }\n"], [20, "  \n"], [21, "\n"], [22, "  secondary_ip_range {\n"], [23, "    range_name    = \"services-range\"\n"], [24, "    ip_cidr_range = \"10.22.0.0/16\"\n"], [25, "  }\n"], [26, "\n"], [27, "  log_config {\n"], [28, "    aggregation_interval = \"INTERVAL_5_SEC\"\n"], [29, "    flow_sampling        = 0.5\n"], [30, "    metadata             = \"INCLUDE_ALL_METADATA\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "/modules/network/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [7, 32], "resource": "module.network.google_compute_subnetwork.subnet", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleSubnetworkLoggingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-logging-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_74", "bc_check_id": "BC_GCP_GENERAL_31", "check_name": "Ensure that private_ip_google_access is enabled for Subnet", "check_result": {"result": "PASSED", "evaluated_keys": ["private_ip_google_access"]}, "code_block": [[7, "resource \"google_compute_subnetwork\" \"subnet\" {\n"], [8, "  project       = var.project_id\n"], [9, "  name          = \"secure-subnet\"\n"], [10, "  ip_cidr_range = \"10.10.0.0/16\"\n"], [11, "  region        = var.region\n"], [12, "  network       = google_compute_network.vpc.id\n"], [13, "  private_ip_google_access = true\n"], [14, "\n"], [15, "  # \u0636\u0631\u0648\u0631\u064a \u0644\u0625\u0636\u0627\u0641\u0629 secondary IP ranges \u0644\u0640 GKE pods \u0648 services\n"], [16, "  secondary_ip_range {\n"], [17, "    range_name    = \"pods-range\"\n"], [18, "    ip_cidr_range = \"10.21.0.0/16\"\n"], [19, "  }\n"], [20, "  \n"], [21, "\n"], [22, "  secondary_ip_range {\n"], [23, "    range_name    = \"services-range\"\n"], [24, "    ip_cidr_range = \"10.22.0.0/16\"\n"], [25, "  }\n"], [26, "\n"], [27, "  log_config {\n"], [28, "    aggregation_interval = \"INTERVAL_5_SEC\"\n"], [29, "    flow_sampling        = 0.5\n"], [30, "    metadata             = \"INCLUDE_ALL_METADATA\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "/modules/network/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [7, 32], "resource": "module.network.google_compute_subnetwork.subnet", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleSubnetworkPrivateGoogleEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [52, 62], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-subnet-has-a-private-ip-google-access", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV_GCP_95", "bc_check_id": "BC_GCP_GENERAL_24", "check_name": "Ensure Memorystore for Redis has AUTH enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["auth_enabled"]}, "code_block": [[1, "resource \"google_redis_instance\" \"redis\" {\n"], [2, "  name               = \"secure-redis\"\n"], [3, "  tier               = var.tier\n"], [4, "  memory_size_gb     = var.memory_size_gb\n"], [5, "  region             = var.region\n"], [6, "  authorized_network = var.network\n"], [7, "  redis_version      = \"REDIS_6_X\"\n"], [8, "  display_name       = \"Secure Redis\"\n"], [9, "  project            = var.project_id\n"], [10, "\n"], [11, "  maintenance_policy {\n"], [12, "    weekly_maintenance_window {\n"], [13, "      day  = \"SATURDAY\"\n"], [14, "      start_time {\n"], [15, "        hours   = 2\n"], [16, "        minutes = 0\n"], [17, "        seconds = 0\n"], [18, "        nanos   = 0\n"], [19, "      }\n"], [20, "    }\n"], [21, "  }\n"], [22, "\n"], [23, "  transit_encryption_mode = \"SERVER_AUTHENTICATION\"\n"], [24, "\n"], [25, "  auth_enabled = true  # \u0625\u0636\u0627\u0641\u0629 \u0647\u0630\u0627 \u0627\u0644\u0633\u0637\u0631 \u0644\u062a\u0641\u0639\u064a\u0644 AUTH\n"], [26, "}\n"]], "file_path": "/modules/redis/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/main.tf", "repo_file_path": "/modules/redis/main.tf", "file_line_range": [1, 26], "resource": "module.redis.google_redis_instance.redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.MemorystoreForRedisAuthEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [128, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-memorystore-for-redis-is-auth-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/main.tf", "breadcrumbs": {"authorized_network": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "memory_size_gb": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "memory_size_gb", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "tier": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "tier", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 25, "source_module_object": null}]}}, {"check_id": "CKV_GCP_97", "bc_check_id": "BC_GCP_GENERAL_11", "check_name": "Ensure Memorystore for Redis uses intransit encryption", "check_result": {"result": "PASSED", "evaluated_keys": ["transit_encryption_mode"]}, "code_block": [[1, "resource \"google_redis_instance\" \"redis\" {\n"], [2, "  name               = \"secure-redis\"\n"], [3, "  tier               = var.tier\n"], [4, "  memory_size_gb     = var.memory_size_gb\n"], [5, "  region             = var.region\n"], [6, "  authorized_network = var.network\n"], [7, "  redis_version      = \"REDIS_6_X\"\n"], [8, "  display_name       = \"Secure Redis\"\n"], [9, "  project            = var.project_id\n"], [10, "\n"], [11, "  maintenance_policy {\n"], [12, "    weekly_maintenance_window {\n"], [13, "      day  = \"SATURDAY\"\n"], [14, "      start_time {\n"], [15, "        hours   = 2\n"], [16, "        minutes = 0\n"], [17, "        seconds = 0\n"], [18, "        nanos   = 0\n"], [19, "      }\n"], [20, "    }\n"], [21, "  }\n"], [22, "\n"], [23, "  transit_encryption_mode = \"SERVER_AUTHENTICATION\"\n"], [24, "\n"], [25, "  auth_enabled = true  # \u0625\u0636\u0627\u0641\u0629 \u0647\u0630\u0627 \u0627\u0644\u0633\u0637\u0631 \u0644\u062a\u0641\u0639\u064a\u0644 AUTH\n"], [26, "}\n"]], "file_path": "/modules/redis/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/main.tf", "repo_file_path": "/modules/redis/main.tf", "file_line_range": [1, 26], "resource": "module.redis.google_redis_instance.redis", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.MemorystoreForRedisInTransitEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [128, 137], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-memorystore-for-redis-uses-intransit-encryption", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/main.tf", "breadcrumbs": {"authorized_network": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "memory_size_gb": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "memory_size_gb", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "tier": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "tier", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/redis/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "redis", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 25, "source_module_object": null}]}}, {"check_id": "CKV_GCP_51", "bc_check_id": "BC_GCP_SQL_2", "check_name": "Ensure PostgreSQL database 'log_checkpoints' flag is set to 'on'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[8]/name", "settings/[0]/database_flags/[8]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogCheckpoints", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_111", "bc_check_id": "BC_GCP_LOGGING_14", "check_name": "Ensure GCP PostgreSQL logs SQL statements", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[3]/name", "settings/[0]/database_flags/[3]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogStatement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-google-cloud-111", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_6", "bc_check_id": "BC_GCP_GENERAL_5", "check_name": "Ensure all Cloud SQL database instance requires all incoming connections to use SSL", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlDatabaseRequireSsl", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-1", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_53", "bc_check_id": "BC_GCP_SQL_4", "check_name": "Ensure PostgreSQL database 'log_disconnections' flag is set to 'on'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[7]/name", "settings/[0]/database_flags/[7]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogDisconnection", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-4", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_11", "bc_check_id": "BC_GCP_NETWORKING_4", "check_name": "Ensure that Cloud SQL database Instances are not open to the world", "check_result": {"result": "PASSED", "evaluated_keys": ["settings/[0]/ip_configuration"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlDatabasePubliclyAccessible", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-4", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_57", "bc_check_id": "BC_GCP_SQL_8", "check_name": "Ensure PostgreSQL database 'log_min_duration_statement' flag is set to '-1'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinDuration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-8", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_109", "bc_check_id": "BC_GCP_LOGGING_12", "check_name": "Ensure the GCP PostgreSQL database log levels are set to ERROR or lower", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[4]/name", "settings/[0]/database_flags/[4]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinErrorStatement", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-google-cloud-109", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_79", "bc_check_id": "BC_GCP_GENERAL_13", "check_name": "Ensure SQL database is using latest Major version", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.CloudSqlMajorVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-sql-database-uses-the-latest-major-version", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_54", "bc_check_id": "BC_GCP_SQL_5", "check_name": "Ensure PostgreSQL database 'log_lock_waits' flag is set to 'on'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[9]/name", "settings/[0]/database_flags/[9]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogLockWaits", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-5", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_14", "bc_check_id": "BC_GCP_GENERAL_6", "check_name": "Ensure all Cloud SQL database instance have backup configuration enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["settings/[0]/backup_configuration/[0]/enabled"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlBackupConfiguration", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-2", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_108", "bc_check_id": "BC_GCP_LOGGING_11", "check_name": "Ensure hostnames are logged for GCP PostgreSQL databases", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[5]/name", "settings/[0]/database_flags/[5]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogHostname", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-google-cloud-108", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_52", "bc_check_id": "BC_GCP_SQL_3", "check_name": "Ensure PostgreSQL database 'log_connections' flag is set to 'on'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[6]/name", "settings/[0]/database_flags/[6]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogConnection", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-3", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_60", "bc_check_id": "BC_GCP_SQL_11", "check_name": "Ensure Cloud SQL database does not have public IP", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlServerNoPublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-11", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_55", "bc_check_id": "BC_GCP_SQL_6", "check_name": "Ensure PostgreSQL database 'log_min_messages' flag is set to a valid value", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinMessage", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-6", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_110", "bc_check_id": "BC_GCP_LOGGING_13", "check_name": "Ensure pgAudit is enabled for your GCP PostgreSQL database", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags/[0]/name", "settings/[0]/database_flags/[0]/value"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlEnablePgaudit", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-google-cloud-110", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV_GCP_56", "bc_check_id": "BC_GCP_SQL_7", "check_name": "Ensure PostgreSQL database 'log_temp_files flag is set to '0'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings/[0]/database_flags"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogTemp", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [108, 125], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-7", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_18", "bc_check_id": "BC_GCP_NETWORKING_22", "check_name": "Ensure GCP network defines a firewall and does not use the default firewall", "check_result": {"result": "PASSED", "entity": {"google_compute_network": {"vpc": {"__end_line__": 5, "__start_line__": 1, "auto_create_subnetworks": [false], "name": ["secure-vpc"], "project": ["task-464917"], "__address__": "module.network.google_compute_network.vpc"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"google_compute_network\" \"vpc\" {\n"], [2, "  project = var.project_id\n"], [3, "  name                    = \"secure-vpc\"\n"], [4, "  auto_create_subnetworks = false\n"], [5, "}\n"]], "file_path": "/modules/network/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "repo_file_path": "/modules/network/main.tf", "file_line_range": [1, 5], "resource": "module.network.google_compute_network.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-2-18", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_19", "bc_check_id": "BC_GCP_KUBERNETES_27", "check_name": "Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled", "check_result": {"result": "PASSED", "entity": {"google_container_cluster": {"gke": {"__end_line__": 81, "__start_line__": 1, "binary_authorization": [{"evaluation_mode": ["PROJECT_SINGLETON_POLICY_ENFORCE"]}], "deletion_protection": [false], "enable_intranode_visibility": [true], "enable_shielded_nodes": [true], "initial_node_count": [1], "ip_allocation_policy": [{"cluster_secondary_range_name": ["pods-range"], "services_secondary_range_name": ["services-range"]}], "location": ["us-central1"], "master_auth": [{"client_certificate_config": [{"issue_client_certificate": [false]}]}], "master_authorized_networks_config": [{"cidr_blocks": [{"cidr_block": ["10.0.0.0/8"], "display_name": ["Internal Network"]}]}], "name": ["secure-gke-cluster"], "network": ["secure-vpc"], "network_policy": [{"enabled": [true], "provider": ["CALICO"]}], "networking_mode": ["VPC_NATIVE"], "node_config": [{"shielded_instance_config": [{"enable_integrity_monitoring": [true], "enable_secure_boot": [true]}], "workload_metadata_config": [{"mode": ["GKE_METADATA"]}]}], "private_cluster_config": [{"enable_private_endpoint": [true], "enable_private_nodes": [true], "master_ipv4_cidr_block": ["172.16.0.0/28"]}], "project": ["task-464917"], "release_channel": [{"channel": ["REGULAR"]}], "remove_default_node_pool": [true], "resource_labels": [{"environment": "dev", "team": "devops"}], "subnetwork": ["secure-subnet"], "workload_identity_config": [{"workload_pool": ["task-464917.svc.id.goog"]}], "__address__": "module.gke.google_container_cluster.gke"}}}, "evaluated_keys": ["enable_kubernetes_alpha"]}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-2-19", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_internal": {"__end_line__": 34, "__start_line__": 12, "allow": [{"ports": [["0-65535"]], "protocol": ["tcp"]}, {"ports": [["0-65535"]], "protocol": ["udp"]}, {"protocol": ["icmp"]}], "direction": ["INGRESS"], "name": ["allow-internal"], "network": ["secure-vpc"], "priority": [1000], "project": ["task-464917"], "source_ranges": [["10.0.0.0/8"]], "__address__": "module.network.google_compute_firewall.allow_internal"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[12, "resource \"google_compute_firewall\" \"allow_internal\" {\n"], [13, "  name    = \"allow-internal\"\n"], [14, "  network = google_compute_network.vpc.name\n"], [15, "  project = var.project_id\n"], [16, "\n"], [17, "  allow {\n"], [18, "    protocol = \"tcp\"\n"], [19, "    ports    = [\"0-65535\"]\n"], [20, "  }\n"], [21, "\n"], [22, "  allow {\n"], [23, "    protocol = \"udp\"\n"], [24, "    ports    = [\"0-65535\"]\n"], [25, "  }\n"], [26, "\n"], [27, "  allow {\n"], [28, "    protocol = \"icmp\"\n"], [29, "  }\n"], [30, "\n"], [31, "  source_ranges = [\"10.0.0.0/8\"]\n"], [32, "  direction     = \"INGRESS\"\n"], [33, "  priority      = 1000\n"], [34, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [12, 34], "resource": "module.network.google_compute_firewall.allow_internal", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "resource", "name": "google_compute_network.vpc", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/main.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_health_checks": {"__end_line__": 49, "__start_line__": 36, "allow": [{"ports": [["10250"]], "protocol": ["tcp"]}], "direction": ["INGRESS"], "name": ["allow-health-checks"], "network": ["secure-vpc"], "priority": [1000], "project": ["task-464917"], "source_ranges": [["130.211.0.0/22", "35.191.0.0/16"]], "__address__": "module.network.google_compute_firewall.allow_health_checks"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[36, "resource \"google_compute_firewall\" \"allow_health_checks\" {\n"], [37, "  project= var.project_id\n"], [38, "  name    = \"allow-health-checks\"\n"], [39, "  network = var.network_name\n"], [40, "\n"], [41, "  allow {\n"], [42, "    protocol = \"tcp\"\n"], [43, "    ports    = [\"10250\"]\n"], [44, "  }\n"], [45, "\n"], [46, "  source_ranges = [\"130.211.0.0/22\", \"35.191.0.0/16\"]\n"], [47, "  direction     = \"INGRESS\"\n"], [48, "  priority      = 1000\n"], [49, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [36, 49], "resource": "module.network.google_compute_firewall.allow_health_checks", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_ssh": {"__end_line__": 64, "__start_line__": 51, "allow": [{"ports": [["22"]], "protocol": ["tcp"]}], "direction": ["INGRESS"], "name": ["allow-ssh"], "network": ["secure-vpc"], "priority": [1000], "project": ["task-464917"], "source_ranges": [["197.49.102.71/32"]], "__address__": "module.network.google_compute_firewall.allow_ssh"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[51, "resource \"google_compute_firewall\" \"allow_ssh\" {\n"], [52, "  project = var.project_id\n"], [53, "  name    = \"allow-ssh\"\n"], [54, "  network = var.network_name\n"], [55, "\n"], [56, "  allow {\n"], [57, "    protocol = \"tcp\"\n"], [58, "    ports    = [\"22\"]\n"], [59, "  }\n"], [60, "\n"], [61, "  source_ranges = var.trusted_ip\n"], [62, "  direction     = \"INGRESS\"\n"], [63, "  priority      = 1000\n"], [64, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [51, 64], "resource": "module.network.google_compute_firewall.allow_ssh", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_https": {"__end_line__": 77, "__start_line__": 65, "allow": [{"ports": [["443"]], "protocol": ["tcp"]}], "direction": ["INGRESS"], "name": ["allow-https"], "network": ["secure-vpc"], "project": ["task-464917"], "source_ranges": [["197.49.102.71/32"]], "__address__": "module.network.google_compute_firewall.allow_https"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[65, "resource \"google_compute_firewall\" \"allow_https\" {\n"], [66, "  name    = \"allow-https\"\n"], [67, "  network = var.network_name\n"], [68, "  project = var.project_id\n"], [69, "\n"], [70, "  allow {\n"], [71, "    protocol = \"tcp\"\n"], [72, "    ports    = [\"443\"]\n"], [73, "  }\n"], [74, "\n"], [75, "  source_ranges = var.trusted_ip # or load balancer IP ranges\n"], [76, "  direction     = \"INGRESS\"\n"], [77, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [65, 77], "resource": "module.network.google_compute_firewall.allow_https", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_redis": {"__end_line__": 91, "__start_line__": 78, "allow": [{"ports": [["6379"]], "protocol": ["tcp"]}], "direction": ["INGRESS"], "name": ["allow-redis"], "network": ["secure-vpc"], "priority": [1000], "project": ["task-464917"], "source_ranges": [["197.49.102.71/32"]], "__address__": "module.network.google_compute_firewall.allow_redis"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[78, "resource \"google_compute_firewall\" \"allow_redis\" {\n"], [79, "  project = var.project_id\n"], [80, "  name    = \"allow-redis\"\n"], [81, "  network = var.network_name\n"], [82, "\n"], [83, "  allow {\n"], [84, "    protocol = \"tcp\"\n"], [85, "    ports    = [\"6379\"]\n"], [86, "  }\n"], [87, "\n"], [88, "  source_ranges = var.trusted_ip # \u0623\u0648 \u0646\u0637\u0627\u0642\u0627\u062a \u062f\u0627\u062e\u0644\u064a\u0629 \u0645\u062d\u062f\u062f\u0629 \u062c\u062f\u064b\u0627 (\u0645\u062b\u0644 subnet \u0627\u0644\u062e\u0627\u0635 \u0628\u0627\u0644\u062e\u062f\u0645\u0627\u062a)\n"], [89, "  direction     = \"INGRESS\"\n"], [90, "  priority      = 1000\n"], [91, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [78, 91], "resource": "module.network.google_compute_firewall.allow_redis", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_jenkins": {"__end_line__": 103, "__start_line__": 92, "allow": [{"ports": [["8080"]], "protocol": ["tcp"]}], "name": ["allow-jenkins"], "network": ["secure-vpc"], "project": ["task-464917"], "source_ranges": [["197.49.102.71/32"]], "target_tags": [["jenkins"]], "__address__": "module.network.google_compute_firewall.allow_jenkins"}}}, "evaluated_keys": ["deny/protocol", "source_ranges", "disabled", "direction", "allow/protocol"]}, "code_block": [[92, "resource \"google_compute_firewall\" \"allow_jenkins\" {\n"], [93, "  name    = \"allow-jenkins\"\n"], [94, "  network = var.network_name\n"], [95, "  project=var.project_id  \n"], [96, "  allow {\n"], [97, "    protocol = \"tcp\"\n"], [98, "    ports    = [\"8080\"]\n"], [99, "  }\n"], [100, "\n"], [101, "  target_tags   = [\"jenkins\"]\n"], [102, "  source_ranges = var.trusted_ip # Or your IP range\n"], [103, "}\n"]], "file_path": "/modules/network/firewall.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "repo_file_path": "/modules/network/firewall.tf", "file_line_range": [92, 103], "resource": "module.network.google_compute_firewall.allow_jenkins", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "breadcrumbs": {"network": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/firewall.tf", "module_connection": false}], "project": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_ranges": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "trusted_ip", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/network/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 22, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_13", "bc_check_id": "BC_GCP_LOGGING_6", "check_name": "Ensure PostgreSQL database flag 'log_duration' is set to 'on'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["settings/database_flags[?(@/name == log_duration & @/value == on)]", "database_version"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-2-13", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_20", "bc_check_id": "BC_GCP_STORAGE_1", "check_name": "Ensure MySQL DB instance has point-in-time recovery backup configured", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["database_version", "master_instance_name", "settings/backup_configuration/binary_log_enabled"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-storage-gcs-policies/bc-gcp-2-20", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_7", "bc_check_id": "BC_GCP_IAM_11", "check_name": "Ensure that a MySQL database instance does not allow anyone to connect with administrative privileges", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["name", "database_version", "resource_type", "password"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-iam-policies/ensure-that-a-mysql-database-instance-does-not-allow-anyone-to-connect-with-administrative-privileges", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_16", "bc_check_id": "BC_GCP_LOGGING_9", "check_name": "Ensure PostgreSQL database flag 'log_planner_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["database_version", "settings/database_flags[*]", "settings/database_flags[?(@/name == log_planner_stats & @/value == on)]"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-2-16", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_14", "bc_check_id": "BC_GCP_LOGGING_7", "check_name": "Ensure PostgreSQL database flag 'log_executor_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["settings/database_flags[?(@/name == log_executor_stats & @/value == on)]", "database_version", "settings/database_flags[*]"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-2-14", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_15", "bc_check_id": "BC_GCP_LOGGING_8", "check_name": "Ensure PostgreSQL database flag 'log_parser_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["settings/database_flags[?(@/name == log_parser_stats & @/value == on)]", "database_version", "settings/database_flags[*]"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-2-15", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}, {"check_id": "CKV2_GCP_17", "bc_check_id": "BC_GCP_LOGGING_10", "check_name": "Ensure PostgreSQL database flag 'log_statement_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"postgres": {"__end_line__": 175, "__start_line__": 23, "database_version": ["POSTGRES_17"], "deletion_protection": [false], "name": ["my-postgres-db"], "project": ["task-464917"], "region": ["us-central1"], "settings": [{"availability_type": ["ZONAL"], "backup_configuration": [{"backup_retention_settings": [{"retained_backups": [30], "retention_unit": ["COUNT"]}], "enabled": [true], "location": ["us-central1"], "point_in_time_recovery_enabled": [true], "start_time": ["03:00"], "transaction_log_retention_days": [7]}], "database_flags": [{"name": ["cloudsql.enable_pgaudit"], "value": ["on"]}, {"name": ["pgaudit.log"], "value": ["all"]}, {"name": ["log_duration"], "value": ["on"]}, {"name": ["log_statement"], "value": ["all"]}, {"name": ["log_min_error_statement"], "value": ["error"]}, {"name": ["log_hostname"], "value": ["on"]}, {"name": ["log_connections"], "value": ["on"]}, {"name": ["log_disconnections"], "value": ["on"]}, {"name": ["log_checkpoints"], "value": ["on"]}, {"name": ["log_lock_waits"], "value": ["on"]}, {"name": ["log_min_duration_statement"], "value": ["-1"]}, {"name": ["ssl_min_protocol_version"], "value": ["TLSv1.2"]}, {"name": ["password_encryption"], "value": ["scram-sha-256"]}, {"name": ["log_statement_stats"], "value": ["off"]}, {"name": ["log_parser_stats"], "value": ["off"]}, {"name": ["log_planner_stats"], "value": ["off"]}, {"name": ["log_executor_stats"], "value": ["off"]}], "disk_autoresize": [true], "disk_autoresize_limit": [100], "disk_size": [20], "disk_type": ["PD_SSD"], "insights_config": [{"query_insights_enabled": [true], "query_string_length": [1024], "record_application_tags": [true], "record_client_address": [true]}], "ip_configuration": [{"enable_private_path_for_google_cloud_services": [true], "ipv4_enabled": [false], "private_network": ["google_compute_network.vpc.self_link"], "ssl_mode": ["TRUSTED_CLIENT_CERTIFICATE_REQUIRED"]}], "maintenance_window": [{"day": [7], "hour": [3], "update_track": ["stable"]}], "tier": ["db-perf-optimized-N-2"]}], "__address__": "module.cloudsql.google_sql_database_instance.postgres"}}}, "evaluated_keys": ["settings/database_flags[?(@/name == log_statement_stats & @/value == on)]", "database_version", "settings/database_flags[*]"]}, "code_block": [[23, "resource \"google_sql_database_instance\" \"postgres\" {\n"], [24, "  project          = var.project_id\n"], [25, "  name             = var.db_instance\n"], [26, "  database_version = \"POSTGRES_17\"\n"], [27, "  region           = var.region\n"], [28, "\n"], [29, "  settings {\n"], [30, "    # Add edition configuration to match tier requirements\n"], [31, "   \n"], [32, "    tier              =  \"db-perf-optimized-N-2\"\n"], [33, "    availability_type = \"ZONAL\"  # or \"REGIONAL\" for HA\n"], [34, "    \n"], [35, "    backup_configuration {\n"], [36, "      enabled                        = true\n"], [37, "      start_time                     = \"03:00\"\n"], [38, "      point_in_time_recovery_enabled = true\n"], [39, "      location                       = var.region\n"], [40, "      transaction_log_retention_days = 7\n"], [41, "      backup_retention_settings {\n"], [42, "        retained_backups = 30\n"], [43, "        retention_unit   = \"COUNT\"\n"], [44, "      }\n"], [45, "    }\n"], [46, "\n"], [47, "    ip_configuration {\n"], [48, "      ipv4_enabled                                  = false\n"], [49, "      private_network                              = var.private_network\n"], [50, "      enable_private_path_for_google_cloud_services = true\n"], [51, "      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n"], [52, "      # Add authorized networks if needed for specific access\n"], [53, "      # authorized_networks {\n"], [54, "      #   name  = \"internal-network\"\n"], [55, "      #   value = \"10.0.0.0/16\"\n"], [56, "      # }\n"], [57, "    }\n"], [58, "\n"], [59, "    disk_autoresize       = true\n"], [60, "    disk_autoresize_limit = 100\n"], [61, "    disk_size             = var.db_disk_size\n"], [62, "    disk_type             = \"PD_SSD\"\n"], [63, "\n"], [64, "    # Maintenance window\n"], [65, "    maintenance_window {\n"], [66, "      day          = 7  # Sunday\n"], [67, "      hour         = 3  # 3 AM\n"], [68, "      update_track = \"stable\"\n"], [69, "    }\n"], [70, "\n"], [71, "    # Query insights\n"], [72, "    insights_config {\n"], [73, "      query_insights_enabled  = true\n"], [74, "      query_string_length    = 1024\n"], [75, "      record_application_tags = true\n"], [76, "      record_client_address  = true\n"], [77, "    }\n"], [78, "    database_flags{\n"], [79, "        name  = \"cloudsql.enable_pgaudit\"\n"], [80, "        value = \"on\"\n"], [81, "    }\n"], [82, "    \n"], [83, "    # 2. Then configure pgaudit settings\n"], [84, "    database_flags {\n"], [85, "      name  = \"pgaudit.log\"\n"], [86, "      value = \"all\"\n"], [87, "    }\n"], [88, "    \n"], [89, "    \n"], [90, "    # Standard PostgreSQL logging flags\n"], [91, "    database_flags {\n"], [92, "      name  = \"log_duration\"\n"], [93, "      value = \"on\"\n"], [94, "    }\n"], [95, "\n"], [96, "    database_flags {\n"], [97, "      name  = \"log_statement\"\n"], [98, "      value = \"all\"\n"], [99, "    }\n"], [100, "\n"], [101, "    database_flags {\n"], [102, "      name  = \"log_min_error_statement\"\n"], [103, "      value = \"error\"\n"], [104, "    }\n"], [105, "\n"], [106, "    database_flags {\n"], [107, "      name  = \"log_hostname\"\n"], [108, "      value = \"on\"\n"], [109, "    }\n"], [110, "\n"], [111, "    database_flags {\n"], [112, "      name  = \"log_connections\"\n"], [113, "      value = \"on\"\n"], [114, "    }\n"], [115, "\n"], [116, "    database_flags {\n"], [117, "      name  = \"log_disconnections\"\n"], [118, "      value = \"on\"\n"], [119, "    }\n"], [120, "\n"], [121, "    database_flags {\n"], [122, "      name  = \"log_checkpoints\"\n"], [123, "      value = \"on\"\n"], [124, "    }\n"], [125, "\n"], [126, "    database_flags {\n"], [127, "      name  = \"log_lock_waits\"\n"], [128, "      value = \"on\"\n"], [129, "    }\n"], [130, "\n"], [131, "    # Additional security flags\n"], [132, "    database_flags {\n"], [133, "      name  = \"log_min_duration_statement\"\n"], [134, "      value = \"-1\"  # Disabled - logs all statements regardless of duration\n"], [135, "    }\n"], [136, "\n"], [137, "    # SSL enforcement through database flags\n"], [138, "       \n"], [139, "    database_flags {\n"], [140, "      name  = \"ssl_min_protocol_version\"\n"], [141, "      value = \"TLSv1.2\"\n"], [142, "    }\n"], [143, "\n"], [144, "    # Additional security hardening flags\n"], [145, "    database_flags {\n"], [146, "      name  = \"password_encryption\"\n"], [147, "      value = \"scram-sha-256\"\n"], [148, "    }\n"], [149, "    \n"], [150, "    database_flags {\n"], [151, "      name  = \"log_statement_stats\"\n"], [152, "      value = \"off\"\n"], [153, "    }\n"], [154, "    \n"], [155, "    database_flags {\n"], [156, "      name  = \"log_parser_stats\"\n"], [157, "      value = \"off\"\n"], [158, "    }\n"], [159, "    \n"], [160, "    database_flags {\n"], [161, "      name  = \"log_planner_stats\"\n"], [162, "      value = \"off\"\n"], [163, "    }\n"], [164, "    \n"], [165, "    database_flags {\n"], [166, "      name  = \"log_executor_stats\"\n"], [167, "      value = \"off\"\n"], [168, "    }\n"], [169, "    \n"], [170, "  } \n"], [171, " \n"], [172, "  deletion_protection = false\n"], [173, "\n"], [174, "  #depends_on = [google_service_networking_connection.private_vpc_connection]\n"], [175, "}\n"]], "file_path": "/modules/sql/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "repo_file_path": "/modules/sql/main.tf", "file_line_range": [23, 175], "resource": "module.cloudsql.google_sql_database_instance.postgres", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-2-17", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "breadcrumbs": {"project": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "region": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "name": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_instance", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_sql_database_instance.postgres", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/main.tf", "module_connection": false}], "settings.backup_configuration.location": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.backup_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.disk_size": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "db_disk_size", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration.private_network": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "settings.ip_configuration": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "private_network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/sql/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "cloudsql", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 24, "source_module_object": null}]}}], "failed_checks": [], "skipped_checks": [{"check_id": "CKV_GCP_65", "bc_check_id": "BC_GCP_KUBERNETES_20", "check_name": "Manage Kubernetes RBAC users with Google Groups for GKE", "check_result": {"result": "SKIPPED", "suppress_comment": "No comment provided"}, "code_block": [[1, "resource \"google_container_cluster\" \"gke\" {\n"], [2, "  project  = var.project_id\n"], [3, "  name     = var.cluster_name\n"], [4, "  location = var.region\n"], [5, "\n"], [6, "  release_channel {\n"], [7, "    channel = \"REGULAR\"\n"], [8, "  }\n"], [9, "# checkov:skip=CKV_GCP_65 reason=\"Google Groups for RBAC is not used in this setup\"\n"], [10, "\n"], [11, "  remove_default_node_pool = true\n"], [12, "  initial_node_count       = 1\n"], [13, "\n"], [14, "  networking_mode = \"VPC_NATIVE\"\n"], [15, "  network         = var.network\n"], [16, "  subnetwork      = var.subnetwork\n"], [17, "\n"], [18, "  enable_shielded_nodes       = true\n"], [19, "  enable_intranode_visibility = true\n"], [20, "\n"], [21, "  ip_allocation_policy {\n"], [22, "    cluster_secondary_range_name  = \"pods-range\"\n"], [23, "    services_secondary_range_name = \"services-range\"\n"], [24, "  }\n"], [25, "\n"], [26, "  private_cluster_config {\n"], [27, "    enable_private_nodes    = true\n"], [28, "    enable_private_endpoint = true\n"], [29, "    master_ipv4_cidr_block  = var.master_cidr\n"], [30, "  }\n"], [31, "\n"], [32, "  master_authorized_networks_config {\n"], [33, "    cidr_blocks {\n"], [34, "      cidr_block   = \"10.0.0.0/8\"     # Private range\n"], [35, "      display_name = \"Internal Network\"\n"], [36, "    }\n"], [37, "    # Or use your VPC's CIDR range\n"], [38, "    # cidr_blocks {\n"], [39, "    #   cidr_block   = \"10.1.0.0/16\"\n"], [40, "    #   display_name = \"VPC Network\"\n"], [41, "    # }\n"], [42, "  }\n"], [43, "\n"], [44, "  workload_identity_config {\n"], [45, "    workload_pool = \"${var.project_id}.svc.id.goog\"\n"], [46, "  }\n"], [47, "\n"], [48, "  \n"], [49, "  binary_authorization {\n"], [50, "    evaluation_mode = \"PROJECT_SINGLETON_POLICY_ENFORCE\"\n"], [51, "  }\n"], [52, "\n"], [53, "  network_policy {\n"], [54, "    enabled  = true\n"], [55, "    provider = \"CALICO\"\n"], [56, "  }\n"], [57, "\n"], [58, "  # Enable GKE Metadata Server (CKV_GCP_69) + Shielded Instance Config\n"], [59, "  node_config {\n"], [60, "    workload_metadata_config {\n"], [61, "      mode = \"GKE_METADATA\"\n"], [62, "    }\n"], [63, "    \n"], [64, "    # ADD THIS: Shielded instance configuration for the cluster\n"], [65, "    shielded_instance_config {\n"], [66, "      enable_secure_boot          = true\n"], [67, "      enable_integrity_monitoring = true\n"], [68, "    }\n"], [69, "  }\n"], [70, "  deletion_protection = false\n"], [71, "  resource_labels = {\n"], [72, "    environment = var.environment\n"], [73, "    team        = \"devops\"\n"], [74, "  }\n"], [75, "\n"], [76, "  master_auth {\n"], [77, "    client_certificate_config {\n"], [78, "      issue_client_certificate = false\n"], [79, "    }\n"], [80, "  }\n"], [81, "}\n"]], "file_path": "/modules/gke/main.tf", "file_abs_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "repo_file_path": "/modules/gke/main.tf", "file_line_range": [1, 81], "resource": "module.gke.google_container_cluster.gke", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEKubernetesRBACGoogleGroups", "fixed_definition": null, "entity_tags": null, "caller_file_path": "/main.tf", "caller_file_line_range": [65, 77], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/manage-kubernetes-rbac-users-with-google-groups-for-gke", "details": [], "check_len": null, "definition_context_file_path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "cluster_name", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/main.tf", "module_connection": false}], "resource_labels.environment": [{"type": "variable", "name": "environment", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "network": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "network", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "subnetwork": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "subnetwork", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "private_cluster_config.master_ipv4_cidr_block": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "master_cidr", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "workload_identity_config.workload_pool": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "project": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "project_id", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "location": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "module_connection": false}, {"type": "variable", "name": "region", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/modules/gke/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "gke", "path": "/home/ahmed/Desktop/Gcp-project/microservices-demo/Terraform/main.tf", "idx": 23, "source_module_object": null}]}}], "parsing_errors": []}, "summary": {"passed": 115, "failed": 0, "skipped": 1, "parsing_errors": 0, "resource_count": 54, "checkov_version": "3.2.447"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}